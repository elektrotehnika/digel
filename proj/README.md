## ПРОЈЕКАТ ИЗ ДИГИТАЛНЕ ЕЛЕКТРОНИКЕ

Ко се бави дигиталном електроником, неретко ће се у каријери сусретати са коришћењем све популарнијих процесора на бази [RISC-V](https://en.wikipedia.org/wiki/RISC-V) архитектуре, било то пројектовање процесорских периферија, писање програма или прављење читавих система заснованих на овим процесорима.

Један од таквих система сигурно је [picosoc](https://github.com/YosysHQ/picorv32/tree/main/picosoc) заснован на  [picorv32](https://github.com/YosysHQ/picorv32) процесорском језгру и као такав биће коришћен као полазна основа за овогодишњи пројекат. Састоји се из споменутог *picorv32* језгра, [RAM меморије](https://en.wikipedia.org/wiki/Random-access_memory) за смештање програма који се извршава, [UART](https://en.wikipedia.org/wiki/Universal_asynchronous_receiver-transmitter) периферије за комуникацију са спољашњим светом, [Quad SPI](https://en.wikipedia.org/wiki/Serial_Peripheral_Interface#Quad_SPI` ) интерфејса ка екстерној [FLASH](https://en.wikipedia.org/wiki/Flash_memory) меморији из које се учитава програм и магистралног интерфејса за повезивање додатних периферија.

Пројектни задатак састоји се из следећих тачака:

1. **прилагођавање *picosoc* система коришћеној SKY130 технологији и OpenROAD алатима** (10 поена)
    - користећи Hammer и QuestaSim, подесити подразумевано (*icebreaker*) симулационо окружење:
        - главни модул `icebreaker` и одговарајући тестбенч преименовати у `digel_soc` и `digel_soc_tb`
        - у главном модулу несинтетизабилне `SB_IO` инстанце заменити комбинационим кодом полудвосмерних тростатичких бафера
        - инсталирати [RISC-V алате за компајлирање](https://github.com/riscv-collab/riscv-gnu-toolchain) (из извора или пробати пакет *gcc-riscv64-unknown-elf*) и на основу подразумеваног [`firmware.c`](https://github.com/YosysHQ/picorv32/blob/main/picosoc/firmware.c) програма генерисати бинарну датотеку *firmare.hex* - програм који се учитава у [*SPI flash* меморијском моделу](https://github.com/YosysHQ/picorv32/blob/main/picosoc/spiflash.v)
        - покренути симулацију са `digel_soc_tb` тестбенчом (и свим RTL датотекама које сачињавају `digel_soc`) и генерисаним `firmware.hex` програмом
    - постојећу RAM меморију (инстанцу *picosoc_ram*) потребно је заменити одговарајућим SKY130 SRAM макроом (рецимо *sram22_256x32m4w8*) и поново покренути симулацију
2. **пројектовање специфичне процесорске периферије** (20 поена)
    - пројектовати генератор таласних облика (енг. *Waveform Generator*) са следећим (или сличним) интерфејсом:
    ```verilog
    module wave_gen (
      input         resetn,
      input         clk,
      input   [3:0] wstrb,
      input  [31:0] addr,
      input  [31:0] wdata,
      output [31:0] rdata,
      output [31:0] wave
    );`
    ```
    - генератор таласних облика треба да подржава следеће режиме рада:
        - генератор је искључен и на `wave` излазу су нуле
        - генератор једнобитних таласних облика (на `wave[0]` излазу)
            - наизменични генератор јединица и нула: "...1...10...01...10...0..."
                - параметри: број узастопних јединица/нула
            - генератор пулсно-ширински модулисаног (енг. [PWM](https://en.wikipedia.org/wiki/Pulse-width_modulation)) сигнала
                - параметри: број тактова кад је излаз 1, број тактова кад је излаз 0
            - [псеудо-насумични сигнал](https://en.wikipedia.org/wiki/Linear-feedback_shift_register)
                - параметри: ширина полинома, XOR маска
        - генератор вишебитних таласних облика
            - [правоугани сигнал](https://en.wikipedia.org/wiki/Square_wave_(waveform))
                - параметри: амплитуда, периода
            - [троугласти сигнал](https://en.wikipedia.org/wiki/Triangle_wave)
                - параметри: амплитуда, корак
            - [тестерасти сигнал](https://en.wikipedia.org/wiki/Sawtooth_wave)
                - параметри: амплитуда, корак
            - [синусни сигнал](https://en.wikipedia.org/wiki/Sine_wave)
                - параметри: амплитуда, периода
        - параметре генератора имплементирати као конфигурационе регистре периферије чија су имена и адресе параметризоване
3. **пројектовање апликације за процесорску периферију** (10 поена)
    - повезати периферију `wave_gen` на *picosoc* систем унутар `digel_soc` главног модула
    - написати C програм `digel_soc.c` који покреће све режиме рада периферије генератора облика и исписује тренутни режим рада на UART;
    - покренути симулацију са тим програмом; таласне облике потребно је сачувати у текстуалним датотекама (параметризовати имена са путањама) у формату *1 линија - 1 вредност* и након симулације исцртати користећи Python скрипту
4. **физичка имплементација система са периферијом** (10 поена)
    - користећи Hammer и OpenROAD, подесити окружење за синтезу и *par*
        - главни модул: `digel_soc`, периода такта: 20ns (50MHz)
        - покушати остварити 0 DRC грешака и *slack* већи од 0.5ns
    - обезбедити успешно покретање теста `digel_soc_tb` и програме `firmware.hex` и `digel_soc.hex` у *gate-level* симулацији

Пројекат се може радити самостално или у пару. Парове је потребно пријавити путем мејла на deki@uni.kg.ac.rs. Пројекат ће се радити и предавати као и лаб-вежбе - путем GitHub-а:

1) пре почетка, направити **приватни** *fork* [пројектног репозиторијума](https://github.com/elektrotehnika/digel-asic-project-fa24) и позвати [сарадника у настави](https://github.com/baywatcher)) као сарадника репозиторијума

2) при предаји, таговати последњи валидни комит сваке тачке (1, 2, 3 и 4) `digel_soc_БРОЈ_ТАЧКЕ` тагом и последњи валидни комит целокупног пројекта `digel_soc` тагом и обавестити сарадника мејлом о завршетку пројекта.

За питања и недоумице јавити се на deki@uni.kg.ac.rs.
